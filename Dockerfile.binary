ARG GO_VERSION
ARG IMAGE_REGISTRY

FROM  library/golang:$GO_VERSION as gobuilder

ARG CGO_ENABLED
ARG GO111MODULE
ARG TARGETOS
ARG GOARCH
ARG APPLICATION_NAME
ARG BUILDOPTS
ARG COMMIT_ID

WORKDIR /$APPLICATION_NAME
COPY . /$APPLICATION_NAME/
RUN  CGO_ENABLED=$CGO_ENABLED GO111MODULE=$GO111MODULE GOOS=$TARGETOS GOARCH=$GOARCH go build -mod=vendor -v -o $APPLICATION_NAME
